<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <title>Payment</title>
    <link rel="stylesheet" href="style.css">
    <!-- Use only one Bootstrap CSS file -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
    <header>
        <div>
            <nav class="navbar navbar-light fixed-top w-100">
                <div class="container-fluid">
                    <a class="navbar-brand" href="index.html">
                        <img src="Assets/Images/logo.png" alt="logo" width="38" height="34" class="d-inline-block align-text-center">
                        <h1 class="h1 as h3 d-inline-block align-text-center text-light fw-bold">MOBICOMM</h1>
                    </a>
                    <div class="me-3">
                        <div class="dropdown">
                            <a class="navbar-brand" href="#" role="button" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="Assets/Images/profile-icon.png" class="float-end me-3" alt="Profile" width="35" height="35">
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                                <li><a class="dropdown-item" href="#">Help</a></li>
                            </ul>
                        </div>
                    </div>    
                </div>
            </nav>
        </div>
    </header>
    <br><br>
    <div class="container mt-5">
        <div class="row">
            <!-- Payment Summary Section -->
            <div class="col-md-5">
                <div class="payment-summary-card  ">
                    <div class="card-header bg-secondary text-white">
                        <h2 class="h4 mb-0">Payment Summary</h2>
                    </div>
                    <div class="card-body">
                        <div id="payment-summary">
                            <!-- Payment summary details will be inserted here dynamically -->
                        </div>
                        <button class="btn btn-success w-100 mt-3" onclick="alert('Payment Successful!')">Pay Now</button>
                    </div>
                </div>
            </div>
    
            <!-- Payment Options Section -->
            <div class="col-md-7">
                <div class="pay_option_card">
                    <div class="card-header">
                        <h2 class="h4 mb-0">Payment Options</h2>
                    </div>
                    <div class="card-body">
                        <div class="accordion accordion-flush" id="accordionFlushExample">
    
                            <!-- UPI Section -->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="flush-headingOne">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne">
                                        <img src="Assets/Images/Upi.webp" alt="UPI" height="35" width="45" class="me-3"/>UPI
                                    </button>
                                </h2>
                                <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                                    <div class="accordion-body">
                                        <a href="#"><img src="Assets/Images/gpay.png" alt="gPay" height="35" width="35" class="me-4"/></a>
                                        <a href="#"><img src="Assets/Images/Phone Pay.avif" alt="PhonePay" height="35" width="35" class="me-4"/></a>
                                        <a href="#"><img src="Assets/Images/Paytm.png" alt="Paytm" height="35" width="35" class="me-4"/></a>
                                        <a href="#"><img src="Assets/Images/amazonpay.png" alt="Amazon Pay" height="35" width="35" class="me-4"/></a>
                                    </div>
                                </div>
                            </div>
    
                            <!-- Net Banking Section -->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="flush-headingTwo">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo">
                                        <img src="Assets/Images/Netbanking.png" alt="Net Banking" height="35" width="35" class="me-4"/>Net Banking
                                    </button>
                                </h2>
                                <div id="flush-collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                                    <div class="accordion-body">
                                        <a href="#"><img src="Assets/Images/sbi.png" alt="SBI" height="35" width="35" class="me-4"/></a>
                                        <a href="#"><img src="Assets/Images/kotak.png" alt="Kotak Mahindra" height="35" width="35" class="me-4"/></a>
                                        <a href="#"><img src="Assets/Images/Axis-bank.png" alt="Axis Bank" height="35" width="35" class="me-4"/></a>
                                        <a href="#"><img src="Assets/Images/icici.png" alt="ICICI Bank" height="35" width="35" class="me-4"/></a>
                                    </div>
                                </div>
                            </div>
    
                            <!-- Card Payment Section -->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="flush-headingThree">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseThree">
                                        <img src="Assets/Images/card.jpg" alt="Card" height="35" width="35" class="me-4"/>Card
                                    </button>
                                </h2>
                                <div id="flush-collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                                    <div class="accordion-body">
                                        <input type="text" placeholder="Enter card number" maxlength="16" required class="form-control m-2">
                                        <input type="month" required class="form-control m-2">
                                        <input type="text" placeholder="CVV" maxlength="3" required class="form-control m-2">
                                        <button class="btn btn-primary w-100 mt-2">Make Payment</button>
                                    </div>
                                </div>
                            </div>
    
                            <!-- Wallet Section -->
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="flush-headingFour">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseFour">
                                        <img src="Assets/Images/wallet.png" alt="Wallet" height="35" width="35" class="me-4"/>Wallet
                                    </button>
                                </h2>
                                <div id="flush-collapseFour" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                                    <div class="accordion-body">
                                        <a href="#"><img src="Assets/Images/apple.png" alt="Apple Wallet" height="35" width="35" class="me-4"/></a>
                                        <a href="#"><img src="Assets/Images/logo.png" alt="Mobicomm Wallet" height="35" width="35" class="me-4"/></a>
                                    </div>
                                </div>
                            </div>
    
                        </div> 
                    </div> 
                </div>
            </div> 
        </div> 
    </div> 
    
<script>
    // Function to get query parameters from the URL
function getQueryParams() {
    const params = {};
    window.location.search.substring(1).split('&').forEach(param => {
        const [key, value] = param.split('=');
        if (key) {
            params[decodeURIComponent(key.trim())] = decodeURIComponent((value || '').trim());
        }
    });
    return params;
}

// Function to parse JSON safely
function safeJSONParse(str) {
    try {
        return JSON.parse(str);
    } catch (e) {
        console.error("Error parsing JSON:", e);
        return null;
    }
}

// Display the payment summary
function displayPaymentSummary() {
    const params = getQueryParams();
    const paymentSummary = document.getElementById('payment-summary');

    console.log("Extracted Parameters:", params); // Debugging log

    // Check if we have a plan parameter (from custom plan)
    if (params.plan) {
        // Parse the plan JSON data
        const plan = safeJSONParse(params.plan);
        
        if (plan) {
            // Format OTT platforms if any
            let ottDescription = 'None';
            if (plan.ottPlatforms && plan.ottPlatforms.length > 0) {
                ottDescription = plan.ottPlatforms.join(', ');
            }
            
            // Create description text
            let descriptionText = `
                Your custom plan includes ${plan.data} GB data, 
                ${plan.voice * 100} voice minutes, 
                ${plan.sms * 100} SMS
            `;
            
            if (plan.ottPlatforms && plan.ottPlatforms.length > 0) {
                descriptionText += `, and subscription to ${ottDescription}`;
            }

            // Display the custom plan details
            paymentSummary.innerHTML = `
                <p><strong>Plan Type:</strong> Custom Plan</p>
                <p><strong>Validity:</strong> ${plan.validityDays} days</p>
                <p><strong>Data:</strong> ${plan.data} GB</p>
                <p><strong>Voice Pack:</strong> ${plan.voice} pack(s) (${plan.voice * 100} minutes)</p>
                <p><strong>SMS Pack:</strong> ${plan.sms} pack(s) (${plan.sms * 100} SMS)</p>
                <p><strong>OTT Platforms:</strong> ${ottDescription}</p>
                <p><strong>Description:</strong> ${descriptionText}</p>
                <p class="total-amount"><strong>Total Amount:</strong> â‚¹${plan.totalAmount}</p>
            `;
        } else {
            paymentSummary.innerHTML = `<p>Error loading custom plan details.</p>`;
        }
    } 
    // Fallback to regular plan parameters
    else if (params.price && params.validity) {
        paymentSummary.innerHTML = `
            <p><strong>Plan Price:</strong> ${params.price}</p>
            <p><strong>Validity:</strong> ${params.validity}</p>
            <p><strong>Data:</strong> ${params.data || 'N/A'}</p>
            <p><strong>Description:</strong> ${params.desc || 'N/A'}</p>
            <p class="total-amount"><strong>Total Amount:</strong> ${params.price}</p>
        `;
    } else {
        paymentSummary.innerHTML = `<p>No plan details found.</p>`;
    }
}

// Call the function to display the payment summary when the page loads
document.addEventListener('DOMContentLoaded', displayPaymentSummary);
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" 
 integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>